'use strict';

/*
Copyright (C) 2013 Adam Schwartz, http://adamschwartz.co

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/

(function () {
  var SELECTOR, addEventListener, clickEvents, numberRegExp, sortable, touchDevice, trimRegExp;

  SELECTOR = 'table[data-sortable]';

  numberRegExp = /^-?[Â£$Â¤]?[\d,.]+%?$/;

  trimRegExp = /^\s+|\s+$/g;

  clickEvents = ['click'];

  touchDevice = 'ontouchstart' in document.documentElement;

  if (touchDevice) {
    clickEvents.push('touchstart');
  }

  addEventListener = function addEventListener(el, event, handler) {
    if (el.addEventListener != null) {
      return el.addEventListener(event, handler, false);
    } else {
      return el.attachEvent("on" + event, handler);
    }
  };

  sortable = {
    init: function init(options) {
      var table, tables, _i, _len, _results;
      if (options == null) {
        options = {};
      }
      if (options.selector == null) {
        options.selector = SELECTOR;
      }
      tables = document.querySelectorAll(options.selector);
      _results = [];
      for (_i = 0, _len = tables.length; _i < _len; _i++) {
        table = tables[_i];
        _results.push(sortable.initTable(table));
      }
      return _results;
    },
    initTable: function initTable(table) {
      var i, th, ths, _i, _len, _ref;
      if (((_ref = table.tHead) != null ? _ref.rows.length : void 0) !== 1) {
        return;
      }
      if (table.getAttribute('data-sortable-initialized') === 'true') {
        return;
      }
      table.setAttribute('data-sortable-initialized', 'true');
      ths = table.querySelectorAll('th');
      for (i = _i = 0, _len = ths.length; _i < _len; i = ++_i) {
        th = ths[i];
        if (th.getAttribute('data-sortable') !== 'false') {
          sortable.setupClickableTH(table, th, i);
        }
      }
      return table;
    },
    setupClickableTH: function setupClickableTH(table, th, i) {
      var eventName, onClick, type, _i, _len, _results;
      type = sortable.getColumnType(table, i);
      onClick = function onClick(e) {
        var compare, item, newSortedDirection, position, row, rowArray, sorted, sortedDirection, tBody, ths, value, _compare, _i, _j, _k, _l, _len, _len1, _len2, _len3, _len4, _m, _ref, _ref1;
        if (e.handled !== true) {
          e.handled = true;
        } else {
          return false;
        }
        sorted = this.getAttribute('data-sorted') === 'true';
        sortedDirection = this.getAttribute('data-sorted-direction');
        if (sorted) {
          newSortedDirection = sortedDirection === 'ascending' ? 'descending' : 'ascending';
        } else {
          newSortedDirection = type.defaultSortDirection;
        }
        ths = this.parentNode.querySelectorAll('th');
        for (_i = 0, _len = ths.length; _i < _len; _i++) {
          th = ths[_i];
          th.setAttribute('data-sorted', 'false');
          th.removeAttribute('data-sorted-direction');
        }
        this.setAttribute('data-sorted', 'true');
        this.setAttribute('data-sorted-direction', newSortedDirection);
        tBody = table.tBodies[0];
        rowArray = [];
        if (!sorted) {
          if (type.compare != null) {
            _compare = type.compare;
          } else {
            _compare = function _compare(a, b) {
              return b - a;
            };
          }
          compare = function compare(a, b) {
            if (a[0] === b[0]) {
              return a[2] - b[2];
            }
            if (type.reverse) {
              return _compare(b[0], a[0]);
            } else {
              return _compare(a[0], b[0]);
            }
          };
          _ref = tBody.rows;
          for (position = _j = 0, _len1 = _ref.length; _j < _len1; position = ++_j) {
            row = _ref[position];
            value = sortable.getNodeValue(row.cells[i]);
            if (type.comparator != null) {
              value = type.comparator(value);
            }
            rowArray.push([value, row, position]);
          }
          rowArray.sort(compare);
          for (_k = 0, _len2 = rowArray.length; _k < _len2; _k++) {
            row = rowArray[_k];
            tBody.appendChild(row[1]);
          }
        } else {
          _ref1 = tBody.rows;
          for (_l = 0, _len3 = _ref1.length; _l < _len3; _l++) {
            item = _ref1[_l];
            rowArray.push(item);
          }
          rowArray.reverse();
          for (_m = 0, _len4 = rowArray.length; _m < _len4; _m++) {
            row = rowArray[_m];
            tBody.appendChild(row);
          }
        }
        if (typeof window['CustomEvent'] === 'function') {
          return typeof table.dispatchEvent === "function" ? table.dispatchEvent(new CustomEvent('Sortable.sorted', {
            bubbles: true
          })) : void 0;
        }
      };
      _results = [];
      for (_i = 0, _len = clickEvents.length; _i < _len; _i++) {
        eventName = clickEvents[_i];
        _results.push(addEventListener(th, eventName, onClick));
      }
      return _results;
    },
    getColumnType: function getColumnType(table, i) {
      var row, specified, text, type, _i, _j, _len, _len1, _ref, _ref1, _ref2;
      specified = (_ref = table.querySelectorAll('th')[i]) != null ? _ref.getAttribute('data-sortable-type') : void 0;
      if (specified != null) {
        return sortable.typesObject[specified];
      }
      _ref1 = table.tBodies[0].rows;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        row = _ref1[_i];
        text = sortable.getNodeValue(row.cells[i]);
        _ref2 = sortable.types;
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          type = _ref2[_j];
          if (type.match(text)) {
            return type;
          }
        }
      }
      return sortable.typesObject.alpha;
    },
    getNodeValue: function getNodeValue(node) {
      var dataValue;
      if (!node) {
        return '';
      }
      dataValue = node.getAttribute('data-value');
      if (dataValue !== null) {
        return dataValue;
      }
      if (typeof node.innerText !== 'undefined') {
        return node.innerText.replace(trimRegExp, '');
      }
      return node.textContent.replace(trimRegExp, '');
    },
    setupTypes: function setupTypes(types) {
      var type, _i, _len, _results;
      sortable.types = types;
      sortable.typesObject = {};
      _results = [];
      for (_i = 0, _len = types.length; _i < _len; _i++) {
        type = types[_i];
        _results.push(sortable.typesObject[type.name] = type);
      }
      return _results;
    }
  };

  sortable.setupTypes([{
    name: 'numeric',
    defaultSortDirection: 'descending',
    match: function match(a) {
      return a.match(numberRegExp);
    },
    comparator: function comparator(a) {
      return parseFloat(a.replace(/[^0-9.-]/g, ''), 10) || 0;
    }
  }, {
    name: 'date',
    defaultSortDirection: 'ascending',
    reverse: true,
    match: function match(a) {
      // never match unless explicitly told to run a date through attribute settings
      return false;
    },
    comparator: function comparator(a) {
      var aArray = a.split('/');
      // ISO = YYYY MM DD - remember that months are 0 based
      var dateA = new Date(aArray[2], aArray[0] - 1, aArray[1]);
      return dateA || 0;
    }
  }, {
    name: 'alpha',
    defaultSortDirection: 'ascending',
    match: function match() {
      return true;
    },
    compare: function compare(a, b) {
      return a.localeCompare(b);
    }
  }]);

  setTimeout(sortable.init, 0);

  if (typeof define === 'function' && define.amd) {
    define(function () {
      return sortable;
    });
  } else if (typeof exports !== 'undefined') {
    module.exports = sortable;
  } else {
    window.Sortable = sortable;
  }
}).call(undefined);
'use strict';

(function () {
  var fileSelect = document.getElementById('fileSelect');
  var fileInput = document.getElementById('fileInput');
  var browse = document.getElementById('browse');
  var table = document.getElementById('people');
  var tableBody = document.getElementById('people-body');
  var tableHeaderElements = document.getElementsByTagName('th');
  var peopleCount = document.getElementById('peopleCount');

  function resetSortStatus(elements) {
    for (var i = 0; i < elements.length; i++) {
      elements[i].removeAttribute('data-sorted');
      elements[i].removeAttribute('data-sorted-direction');
    }
  }

  function buildTdElem(type, value, image) {
    if (image) {
      return '<td class="i"><span class="' + type + '"></span>' + value + '</td>';
    } else {
      return '<td class="' + type + '">' + value + '</td>';
    }
  }

  function constructRows(values) {
    var trHTML = '';
    var _iteratorNormalCompletion = true;
    var _didIteratorError = false;
    var _iteratorError = undefined;

    try {
      for (var _iterator = values[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
        var value = _step.value;

        trHTML += '<tr>';
        trHTML += buildTdElem('last', value.last, false);
        trHTML += buildTdElem('first', value.first, false);
        if (value.m === 'None') {
          trHTML += buildTdElem('none', value.m, false);
        } else {
          trHTML += buildTdElem('m', value.m, false);
        }
        trHTML += buildTdElem(value.pet.toLowerCase(), value.pet, true);
        trHTML += buildTdElem('birthday', value.birthday, false);
        trHTML += buildTdElem('color', value.color, false);
        trHTML += '</tr>';
      }
    } catch (err) {
      _didIteratorError = true;
      _iteratorError = err;
    } finally {
      try {
        if (!_iteratorNormalCompletion && _iterator.return) {
          _iterator.return();
        }
      } finally {
        if (_didIteratorError) {
          throw _iteratorError;
        }
      }
    }

    return trHTML;
  }

  async function sendFileRequest(req) {
    return fetch(req).then(function (res) {
      if (res.ok) {
        var contentType = res.headers.get('Content-Type');
        if (contentType && contentType.includes('application/json')) {
          return res.json();
        } else {
          return Promise.reject('Unexpected Content-Type');
        }
      } else {
        return Promise.reject('Response not 200 - 299');
      }
    });
  }

  fileSelect.addEventListener('click', function (e) {
    if (fileSelect) {
      fileInput.click();
    }
  });

  browse.addEventListener('click', function (e) {
    if (fileInput) {
      fileInput.click();
    }
  });

  fileInput.addEventListener('change', async function (e) {
    e.preventDefault();
    var data = new FormData();
    data.append("csv", fileInput.files[0]);
    var req = new Request('/upload', {
      method: 'POST',
      body: data
    });

    // insert the name of the file last sent into the fileSelect element
    fileSelect.innerHTML = fileInput.files[0].name;
    fileInput.value = '';

    table.setAttribute('data-sortable-initialized', false);
    resetSortStatus(tableHeaderElements);

    sendFileRequest(req).then(function (res) {
      var trHTML = constructRows(res);
      tableBody.insertAdjacentHTML('beforeend', trHTML);
      Sortable.init();

      var rows = table.getElementsByTagName("tbody")[0].getElementsByTagName("tr").length;
      peopleCount.innerHTML = rows;
    }).catch(function (e) {
      console.log(e);
    });
  });
})();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvcnRhYmxlLmpzIiwiYXBwLmpzIl0sIm5hbWVzIjpbIlNFTEVDVE9SIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsaWNrRXZlbnRzIiwibnVtYmVyUmVnRXhwIiwic29ydGFibGUiLCJ0b3VjaERldmljZSIsInRyaW1SZWdFeHAiLCJkb2N1bWVudCIsImRvY3VtZW50RWxlbWVudCIsInB1c2giLCJlbCIsImV2ZW50IiwiaGFuZGxlciIsImF0dGFjaEV2ZW50IiwiaW5pdCIsIm9wdGlvbnMiLCJ0YWJsZSIsInRhYmxlcyIsIl9pIiwiX2xlbiIsIl9yZXN1bHRzIiwic2VsZWN0b3IiLCJxdWVyeVNlbGVjdG9yQWxsIiwibGVuZ3RoIiwiaW5pdFRhYmxlIiwiaSIsInRoIiwidGhzIiwiX3JlZiIsInRIZWFkIiwicm93cyIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInNldHVwQ2xpY2thYmxlVEgiLCJldmVudE5hbWUiLCJvbkNsaWNrIiwidHlwZSIsImdldENvbHVtblR5cGUiLCJlIiwiY29tcGFyZSIsIml0ZW0iLCJuZXdTb3J0ZWREaXJlY3Rpb24iLCJwb3NpdGlvbiIsInJvdyIsInJvd0FycmF5Iiwic29ydGVkIiwic29ydGVkRGlyZWN0aW9uIiwidEJvZHkiLCJ2YWx1ZSIsIl9jb21wYXJlIiwiX2oiLCJfayIsIl9sIiwiX2xlbjEiLCJfbGVuMiIsIl9sZW4zIiwiX2xlbjQiLCJfbSIsIl9yZWYxIiwiaGFuZGxlZCIsImRlZmF1bHRTb3J0RGlyZWN0aW9uIiwicGFyZW50Tm9kZSIsInJlbW92ZUF0dHJpYnV0ZSIsInRCb2RpZXMiLCJhIiwiYiIsInJldmVyc2UiLCJnZXROb2RlVmFsdWUiLCJjZWxscyIsImNvbXBhcmF0b3IiLCJzb3J0IiwiYXBwZW5kQ2hpbGQiLCJ3aW5kb3ciLCJkaXNwYXRjaEV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJidWJibGVzIiwic3BlY2lmaWVkIiwidGV4dCIsIl9yZWYyIiwidHlwZXNPYmplY3QiLCJ0eXBlcyIsIm1hdGNoIiwiYWxwaGEiLCJub2RlIiwiZGF0YVZhbHVlIiwiaW5uZXJUZXh0IiwicmVwbGFjZSIsInRleHRDb250ZW50Iiwic2V0dXBUeXBlcyIsIm5hbWUiLCJwYXJzZUZsb2F0IiwiYUFycmF5Iiwic3BsaXQiLCJkYXRlQSIsIkRhdGUiLCJsb2NhbGVDb21wYXJlIiwic2V0VGltZW91dCIsImRlZmluZSIsImFtZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJTb3J0YWJsZSIsImNhbGwiLCJmaWxlU2VsZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmaWxlSW5wdXQiLCJicm93c2UiLCJ0YWJsZUJvZHkiLCJ0YWJsZUhlYWRlckVsZW1lbnRzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJwZW9wbGVDb3VudCIsInJlc2V0U29ydFN0YXR1cyIsImVsZW1lbnRzIiwiYnVpbGRUZEVsZW0iLCJpbWFnZSIsImNvbnN0cnVjdFJvd3MiLCJ2YWx1ZXMiLCJ0ckhUTUwiLCJsYXN0IiwiZmlyc3QiLCJtIiwicGV0IiwidG9Mb3dlckNhc2UiLCJiaXJ0aGRheSIsImNvbG9yIiwic2VuZEZpbGVSZXF1ZXN0IiwicmVxIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJjb250ZW50VHlwZSIsImhlYWRlcnMiLCJnZXQiLCJpbmNsdWRlcyIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwiY2xpY2siLCJwcmV2ZW50RGVmYXVsdCIsImRhdGEiLCJGb3JtRGF0YSIsImFwcGVuZCIsImZpbGVzIiwiUmVxdWVzdCIsIm1ldGhvZCIsImJvZHkiLCJpbm5lckhUTUwiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJjYXRjaCIsImNvbnNvbGUiLCJsb2ciXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFzQkEsQ0FBQyxZQUFXO0FBQ1YsTUFBSUEsUUFBSixFQUFjQyxnQkFBZCxFQUFnQ0MsV0FBaEMsRUFBNkNDLFlBQTdDLEVBQTJEQyxRQUEzRCxFQUFxRUMsV0FBckUsRUFBa0ZDLFVBQWxGOztBQUVBTixhQUFX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QUFVc0MsS0FBVixDQUFnQixDQUFoQixDQUFuQjtBQUNBLFFBQU1qQixNQUFNLElBQUlrQixPQUFKLENBQVksU0FBWixFQUF1QjtBQUNqQ0MsY0FBUSxNQUR5QjtBQUVqQ0MsWUFBTU47QUFGMkIsS0FBdkIsQ0FBWjs7QUFLQTtBQUNBckMsZUFBVzRDLFNBQVgsR0FBdUIxQyxVQUFVc0MsS0FBVixDQUFnQixDQUFoQixFQUFtQnRELElBQTFDO0FBQ0FnQixjQUFVekQsS0FBVixHQUFrQixFQUFsQjs7QUFFQWhDLFVBQU1nQixZQUFOLENBQW1CLDJCQUFuQixFQUFnRCxLQUFoRDtBQUNBK0Usb0JBQWdCSCxtQkFBaEI7O0FBRUFpQixvQkFBZ0JDLEdBQWhCLEVBQ0NFLElBREQsQ0FDTSxVQUFDQyxHQUFELEVBQVM7QUFDYixVQUFJWixTQUFTRixjQUFjYyxHQUFkLENBQWI7QUFDQXRCLGdCQUFVeUMsa0JBQVYsQ0FBNkIsV0FBN0IsRUFBMEMvQixNQUExQztBQUNBaEIsZUFBU3ZGLElBQVQ7O0FBRUEsVUFBTWdCLE9BQU9kLE1BQU02RixvQkFBTixDQUEyQixPQUEzQixFQUFvQyxDQUFwQyxFQUF1Q0Esb0JBQXZDLENBQTRELElBQTVELEVBQWtFdEYsTUFBL0U7QUFDQXVGLGtCQUFZcUMsU0FBWixHQUF3QnJILElBQXhCO0FBQ0QsS0FSRCxFQVNDdUgsS0FURCxDQVNPLFVBQUMvRyxDQUFELEVBQU87QUFDWmdILGNBQVFDLEdBQVIsQ0FBWWpILENBQVo7QUFDRCxLQVhEO0FBWUQsR0E1QkQ7QUE2QkQsQ0FwR0QiLCJmaWxlIjoiYWxsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgKEMpIDIwMTMgQWRhbSBTY2h3YXJ0eiwgaHR0cDovL2FkYW1zY2h3YXJ0ei5jb1xuXG5QZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG5vZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG5pbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG50byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG5jb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbmZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cblRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG5hbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG5GSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbkxJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG5PVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG5USEUgU09GVFdBUkUuXG4qL1xuXG4oZnVuY3Rpb24oKSB7XG4gIHZhciBTRUxFQ1RPUiwgYWRkRXZlbnRMaXN0ZW5lciwgY2xpY2tFdmVudHMsIG51bWJlclJlZ0V4cCwgc29ydGFibGUsIHRvdWNoRGV2aWNlLCB0cmltUmVnRXhwO1xuXG4gIFNFTEVDVE9SID0gJ3RhYmxlW2RhdGEtc29ydGFibGVdJztcblxuICBudW1iZXJSZWdFeHAgPSAvXi0/W8OCwqMkw4LCpF0/W1xcZCwuXSslPyQvO1xuXG4gIHRyaW1SZWdFeHAgPSAvXlxccyt8XFxzKyQvZztcblxuICBjbGlja0V2ZW50cyA9IFsnY2xpY2snXTtcblxuICB0b3VjaERldmljZSA9ICdvbnRvdWNoc3RhcnQnIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcblxuICBpZiAodG91Y2hEZXZpY2UpIHtcbiAgICBjbGlja0V2ZW50cy5wdXNoKCd0b3VjaHN0YXJ0Jyk7XG4gIH1cblxuICBhZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oZWwsIGV2ZW50LCBoYW5kbGVyKSB7XG4gICAgaWYgKGVsLmFkZEV2ZW50TGlzdGVuZXIgIT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGVsLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGVsLmF0dGFjaEV2ZW50KFwib25cIiArIGV2ZW50LCBoYW5kbGVyKTtcbiAgICB9XG4gIH07XG5cbiAgc29ydGFibGUgPSB7XG4gICAgaW5pdDogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgdmFyIHRhYmxlLCB0YWJsZXMsIF9pLCBfbGVuLCBfcmVzdWx0cztcbiAgICAgIGlmIChvcHRpb25zID09IG51bGwpIHtcbiAgICAgICAgb3B0aW9ucyA9IHt9O1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMuc2VsZWN0b3IgPT0gbnVsbCkge1xuICAgICAgICBvcHRpb25zLnNlbGVjdG9yID0gU0VMRUNUT1I7XG4gICAgICB9XG4gICAgICB0YWJsZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKG9wdGlvbnMuc2VsZWN0b3IpO1xuICAgICAgX3Jlc3VsdHMgPSBbXTtcbiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gdGFibGVzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XG4gICAgICAgIHRhYmxlID0gdGFibGVzW19pXTtcbiAgICAgICAgX3Jlc3VsdHMucHVzaChzb3J0YWJsZS5pbml0VGFibGUodGFibGUpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBfcmVzdWx0cztcbiAgICB9LFxuICAgIGluaXRUYWJsZTogZnVuY3Rpb24odGFibGUpIHtcbiAgICAgIHZhciBpLCB0aCwgdGhzLCBfaSwgX2xlbiwgX3JlZjtcbiAgICAgIGlmICgoKF9yZWYgPSB0YWJsZS50SGVhZCkgIT0gbnVsbCA/IF9yZWYucm93cy5sZW5ndGggOiB2b2lkIDApICE9PSAxKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0YWJsZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtc29ydGFibGUtaW5pdGlhbGl6ZWQnKSA9PT0gJ3RydWUnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRhYmxlLnNldEF0dHJpYnV0ZSgnZGF0YS1zb3J0YWJsZS1pbml0aWFsaXplZCcsICd0cnVlJyk7XG4gICAgICB0aHMgPSB0YWJsZS5xdWVyeVNlbGVjdG9yQWxsKCd0aCcpO1xuICAgICAgZm9yIChpID0gX2kgPSAwLCBfbGVuID0gdGhzLmxlbmd0aDsgX2kgPCBfbGVuOyBpID0gKytfaSkge1xuICAgICAgICB0aCA9IHRoc1tpXTtcbiAgICAgICAgaWYgKHRoLmdldEF0dHJpYnV0ZSgnZGF0YS1zb3J0YWJsZScpICE9PSAnZmFsc2UnKSB7XG4gICAgICAgICAgc29ydGFibGUuc2V0dXBDbGlja2FibGVUSCh0YWJsZSwgdGgsIGkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdGFibGU7XG4gICAgfSxcbiAgICBzZXR1cENsaWNrYWJsZVRIOiBmdW5jdGlvbih0YWJsZSwgdGgsIGkpIHtcbiAgICAgIHZhciBldmVudE5hbWUsIG9uQ2xpY2ssIHR5cGUsIF9pLCBfbGVuLCBfcmVzdWx0cztcbiAgICAgIHR5cGUgPSBzb3J0YWJsZS5nZXRDb2x1bW5UeXBlKHRhYmxlLCBpKTtcbiAgICAgIG9uQ2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciBjb21wYXJlLCBpdGVtLCBuZXdTb3J0ZWREaXJlY3Rpb24sIHBvc2l0aW9uLCByb3csIHJvd0FycmF5LCBzb3J0ZWQsIHNvcnRlZERpcmVjdGlvbiwgdEJvZHksIHRocywgdmFsdWUsIF9jb21wYXJlLCBfaSwgX2osIF9rLCBfbCwgX2xlbiwgX2xlbjEsIF9sZW4yLCBfbGVuMywgX2xlbjQsIF9tLCBfcmVmLCBfcmVmMTtcbiAgICAgICAgaWYgKGUuaGFuZGxlZCAhPT0gdHJ1ZSkge1xuICAgICAgICAgIGUuaGFuZGxlZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHNvcnRlZCA9IHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLXNvcnRlZCcpID09PSAndHJ1ZSc7XG4gICAgICAgIHNvcnRlZERpcmVjdGlvbiA9IHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLXNvcnRlZC1kaXJlY3Rpb24nKTtcbiAgICAgICAgaWYgKHNvcnRlZCkge1xuICAgICAgICAgIG5ld1NvcnRlZERpcmVjdGlvbiA9IHNvcnRlZERpcmVjdGlvbiA9PT0gJ2FzY2VuZGluZycgPyAnZGVzY2VuZGluZycgOiAnYXNjZW5kaW5nJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdTb3J0ZWREaXJlY3Rpb24gPSB0eXBlLmRlZmF1bHRTb3J0RGlyZWN0aW9uO1xuICAgICAgICB9XG4gICAgICAgIHRocyA9IHRoaXMucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yQWxsKCd0aCcpO1xuICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IHRocy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xuICAgICAgICAgIHRoID0gdGhzW19pXTtcbiAgICAgICAgICB0aC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc29ydGVkJywgJ2ZhbHNlJyk7XG4gICAgICAgICAgdGgucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXNvcnRlZC1kaXJlY3Rpb24nKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZSgnZGF0YS1zb3J0ZWQnLCAndHJ1ZScpO1xuICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZSgnZGF0YS1zb3J0ZWQtZGlyZWN0aW9uJywgbmV3U29ydGVkRGlyZWN0aW9uKTtcbiAgICAgICAgdEJvZHkgPSB0YWJsZS50Qm9kaWVzWzBdO1xuICAgICAgICByb3dBcnJheSA9IFtdO1xuICAgICAgICBpZiAoIXNvcnRlZCkge1xuICAgICAgICAgIGlmICh0eXBlLmNvbXBhcmUgIT0gbnVsbCkge1xuICAgICAgICAgICAgX2NvbXBhcmUgPSB0eXBlLmNvbXBhcmU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF9jb21wYXJlID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgICByZXR1cm4gYiAtIGE7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb21wYXJlID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgaWYgKGFbMF0gPT09IGJbMF0pIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGFbMl0gLSBiWzJdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUucmV2ZXJzZSkge1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbXBhcmUoYlswXSwgYVswXSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gX2NvbXBhcmUoYVswXSwgYlswXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgICBfcmVmID0gdEJvZHkucm93cztcbiAgICAgICAgICBmb3IgKHBvc2l0aW9uID0gX2ogPSAwLCBfbGVuMSA9IF9yZWYubGVuZ3RoOyBfaiA8IF9sZW4xOyBwb3NpdGlvbiA9ICsrX2opIHtcbiAgICAgICAgICAgIHJvdyA9IF9yZWZbcG9zaXRpb25dO1xuICAgICAgICAgICAgdmFsdWUgPSBzb3J0YWJsZS5nZXROb2RlVmFsdWUocm93LmNlbGxzW2ldKTtcbiAgICAgICAgICAgIGlmICh0eXBlLmNvbXBhcmF0b3IgIT0gbnVsbCkge1xuICAgICAgICAgICAgICB2YWx1ZSA9IHR5cGUuY29tcGFyYXRvcih2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByb3dBcnJheS5wdXNoKFt2YWx1ZSwgcm93LCBwb3NpdGlvbl0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByb3dBcnJheS5zb3J0KGNvbXBhcmUpO1xuICAgICAgICAgIGZvciAoX2sgPSAwLCBfbGVuMiA9IHJvd0FycmF5Lmxlbmd0aDsgX2sgPCBfbGVuMjsgX2srKykge1xuICAgICAgICAgICAgcm93ID0gcm93QXJyYXlbX2tdO1xuICAgICAgICAgICAgdEJvZHkuYXBwZW5kQ2hpbGQocm93WzFdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3JlZjEgPSB0Qm9keS5yb3dzO1xuICAgICAgICAgIGZvciAoX2wgPSAwLCBfbGVuMyA9IF9yZWYxLmxlbmd0aDsgX2wgPCBfbGVuMzsgX2wrKykge1xuICAgICAgICAgICAgaXRlbSA9IF9yZWYxW19sXTtcbiAgICAgICAgICAgIHJvd0FycmF5LnB1c2goaXRlbSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJvd0FycmF5LnJldmVyc2UoKTtcbiAgICAgICAgICBmb3IgKF9tID0gMCwgX2xlbjQgPSByb3dBcnJheS5sZW5ndGg7IF9tIDwgX2xlbjQ7IF9tKyspIHtcbiAgICAgICAgICAgIHJvdyA9IHJvd0FycmF5W19tXTtcbiAgICAgICAgICAgIHRCb2R5LmFwcGVuZENoaWxkKHJvdyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93WydDdXN0b21FdmVudCddID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgcmV0dXJuIHR5cGVvZiB0YWJsZS5kaXNwYXRjaEV2ZW50ID09PSBcImZ1bmN0aW9uXCIgPyB0YWJsZS5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnU29ydGFibGUuc29ydGVkJywge1xuICAgICAgICAgICAgYnViYmxlczogdHJ1ZVxuICAgICAgICAgIH0pKSA6IHZvaWQgMDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIF9yZXN1bHRzID0gW107XG4gICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGNsaWNrRXZlbnRzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XG4gICAgICAgIGV2ZW50TmFtZSA9IGNsaWNrRXZlbnRzW19pXTtcbiAgICAgICAgX3Jlc3VsdHMucHVzaChhZGRFdmVudExpc3RlbmVyKHRoLCBldmVudE5hbWUsIG9uQ2xpY2spKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBfcmVzdWx0cztcbiAgICB9LFxuICAgIGdldENvbHVtblR5cGU6IGZ1bmN0aW9uKHRhYmxlLCBpKSB7XG4gICAgICB2YXIgcm93LCBzcGVjaWZpZWQsIHRleHQsIHR5cGUsIF9pLCBfaiwgX2xlbiwgX2xlbjEsIF9yZWYsIF9yZWYxLCBfcmVmMjtcbiAgICAgIHNwZWNpZmllZCA9IChfcmVmID0gdGFibGUucXVlcnlTZWxlY3RvckFsbCgndGgnKVtpXSkgIT0gbnVsbCA/IF9yZWYuZ2V0QXR0cmlidXRlKCdkYXRhLXNvcnRhYmxlLXR5cGUnKSA6IHZvaWQgMDtcbiAgICAgIGlmIChzcGVjaWZpZWQgIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gc29ydGFibGUudHlwZXNPYmplY3Rbc3BlY2lmaWVkXTtcbiAgICAgIH1cbiAgICAgIF9yZWYxID0gdGFibGUudEJvZGllc1swXS5yb3dzO1xuICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmMS5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xuICAgICAgICByb3cgPSBfcmVmMVtfaV07XG4gICAgICAgIHRleHQgPSBzb3J0YWJsZS5nZXROb2RlVmFsdWUocm93LmNlbGxzW2ldKTtcbiAgICAgICAgX3JlZjIgPSBzb3J0YWJsZS50eXBlcztcbiAgICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZjIubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7XG4gICAgICAgICAgdHlwZSA9IF9yZWYyW19qXTtcbiAgICAgICAgICBpZiAodHlwZS5tYXRjaCh0ZXh0KSkge1xuICAgICAgICAgICAgcmV0dXJuIHR5cGU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gc29ydGFibGUudHlwZXNPYmplY3QuYWxwaGE7XG4gICAgfSxcbiAgICBnZXROb2RlVmFsdWU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIHZhciBkYXRhVmFsdWU7XG4gICAgICBpZiAoIW5vZGUpIHtcbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuICAgICAgZGF0YVZhbHVlID0gbm9kZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnKTtcbiAgICAgIGlmIChkYXRhVmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGRhdGFWYWx1ZTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2Ygbm9kZS5pbm5lclRleHQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiBub2RlLmlubmVyVGV4dC5yZXBsYWNlKHRyaW1SZWdFeHAsICcnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBub2RlLnRleHRDb250ZW50LnJlcGxhY2UodHJpbVJlZ0V4cCwgJycpO1xuICAgIH0sXG4gICAgc2V0dXBUeXBlczogZnVuY3Rpb24odHlwZXMpIHtcbiAgICAgIHZhciB0eXBlLCBfaSwgX2xlbiwgX3Jlc3VsdHM7XG4gICAgICBzb3J0YWJsZS50eXBlcyA9IHR5cGVzO1xuICAgICAgc29ydGFibGUudHlwZXNPYmplY3QgPSB7fTtcbiAgICAgIF9yZXN1bHRzID0gW107XG4gICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IHR5cGVzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XG4gICAgICAgIHR5cGUgPSB0eXBlc1tfaV07XG4gICAgICAgIF9yZXN1bHRzLnB1c2goc29ydGFibGUudHlwZXNPYmplY3RbdHlwZS5uYW1lXSA9IHR5cGUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIF9yZXN1bHRzO1xuICAgIH1cbiAgfTtcblxuICBzb3J0YWJsZS5zZXR1cFR5cGVzKFtcbiAgICB7XG4gICAgICBuYW1lOiAnbnVtZXJpYycsXG4gICAgICBkZWZhdWx0U29ydERpcmVjdGlvbjogJ2Rlc2NlbmRpbmcnLFxuICAgICAgbWF0Y2g6IGZ1bmN0aW9uKGEpIHtcbiAgICAgICAgcmV0dXJuIGEubWF0Y2gobnVtYmVyUmVnRXhwKTtcbiAgICAgIH0sXG4gICAgICBjb21wYXJhdG9yOiBmdW5jdGlvbihhKSB7XG4gICAgICAgIHJldHVybiBwYXJzZUZsb2F0KGEucmVwbGFjZSgvW14wLTkuLV0vZywgJycpLCAxMCkgfHwgMDtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBuYW1lOiAnZGF0ZScsXG4gICAgICBkZWZhdWx0U29ydERpcmVjdGlvbjogJ2FzY2VuZGluZycsXG4gICAgICByZXZlcnNlOiB0cnVlLFxuICAgICAgbWF0Y2g6IGZ1bmN0aW9uKGEpIHtcbiAgICAgICAgLy8gbmV2ZXIgbWF0Y2ggdW5sZXNzIGV4cGxpY2l0bHkgdG9sZCB0byBydW4gYSBkYXRlIHRocm91Z2ggYXR0cmlidXRlIHNldHRpbmdzXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0sXG4gICAgICBjb21wYXJhdG9yOiBmdW5jdGlvbihhKSB7XG4gICAgICAgIHZhciBhQXJyYXkgPSBhLnNwbGl0KCcvJyk7XG4gICAgICAgIC8vIElTTyA9IFlZWVkgTU0gREQgLSByZW1lbWJlciB0aGF0IG1vbnRocyBhcmUgMCBiYXNlZFxuICAgICAgICB2YXIgZGF0ZUEgPSBuZXcgRGF0ZShhQXJyYXlbMl0sIGFBcnJheVswXSAtIDEsIGFBcnJheVsxXSk7XG4gICAgICAgIHJldHVybiBkYXRlQSB8fCAwO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIG5hbWU6ICdhbHBoYScsXG4gICAgICBkZWZhdWx0U29ydERpcmVjdGlvbjogJ2FzY2VuZGluZycsXG4gICAgICBtYXRjaDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSxcbiAgICAgIGNvbXBhcmU6IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEubG9jYWxlQ29tcGFyZShiKTtcbiAgICAgIH1cbiAgICB9XG4gIF0pO1xuXG4gIHNldFRpbWVvdXQoc29ydGFibGUuaW5pdCwgMCk7XG5cbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzb3J0YWJsZTtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHNvcnRhYmxlO1xuICB9IGVsc2Uge1xuICAgIHdpbmRvdy5Tb3J0YWJsZSA9IHNvcnRhYmxlO1xuICB9XG5cbn0pLmNhbGwodGhpcyk7XG4iLCIoKCkgPT4ge1xuICBjb25zdCBmaWxlU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVTZWxlY3QnKTtcbiAgY29uc3QgZmlsZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVJbnB1dCcpO1xuICBjb25zdCBicm93c2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnJvd3NlJyk7XG4gIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Blb3BsZScpO1xuICBjb25zdCB0YWJsZUJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGVvcGxlLWJvZHknKTtcbiAgY29uc3QgdGFibGVIZWFkZXJFbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0aCcpO1xuICBjb25zdCBwZW9wbGVDb3VudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZW9wbGVDb3VudCcpO1xuICBcbiAgZnVuY3Rpb24gcmVzZXRTb3J0U3RhdHVzKGVsZW1lbnRzKSB7XG4gICAgZm9yKGxldCBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBlbGVtZW50c1tpXS5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc29ydGVkJyk7XG4gICAgICBlbGVtZW50c1tpXS5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc29ydGVkLWRpcmVjdGlvbicpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGJ1aWxkVGRFbGVtKHR5cGUsIHZhbHVlLCBpbWFnZSkge1xuICAgIGlmKGltYWdlKSB7XG4gICAgICByZXR1cm4gJzx0ZCBjbGFzcz1cImlcIj48c3BhbiBjbGFzcz1cIicgKyB0eXBlICsgJ1wiPjwvc3Bhbj4nICsgdmFsdWUgKyAnPC90ZD4nO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJzx0ZCBjbGFzcz1cIicgKyB0eXBlICsgJ1wiPicgKyB2YWx1ZSArICc8L3RkPic7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY29uc3RydWN0Um93cyh2YWx1ZXMpIHtcbiAgICBsZXQgdHJIVE1MID0gJyc7XG4gICAgZm9yKGxldCB2YWx1ZSBvZiB2YWx1ZXMpIHtcbiAgICAgIHRySFRNTCArPSAnPHRyPic7XG4gICAgICB0ckhUTUwgKz0gYnVpbGRUZEVsZW0oJ2xhc3QnLCB2YWx1ZS5sYXN0LCBmYWxzZSk7XG4gICAgICB0ckhUTUwgKz0gYnVpbGRUZEVsZW0oJ2ZpcnN0JywgdmFsdWUuZmlyc3QsIGZhbHNlKTtcbiAgICAgIGlmKHZhbHVlLm0gPT09ICdOb25lJykge1xuICAgICAgICB0ckhUTUwgKz0gYnVpbGRUZEVsZW0oJ25vbmUnLCB2YWx1ZS5tLCBmYWxzZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0ckhUTUwgKz0gYnVpbGRUZEVsZW0oJ20nLCB2YWx1ZS5tLCBmYWxzZSk7XG4gICAgICB9ICAgICAgXG4gICAgICB0ckhUTUwgKz0gYnVpbGRUZEVsZW0odmFsdWUucGV0LnRvTG93ZXJDYXNlKCksIHZhbHVlLnBldCwgdHJ1ZSk7XG4gICAgICB0ckhUTUwgKz0gYnVpbGRUZEVsZW0oJ2JpcnRoZGF5JywgdmFsdWUuYmlydGhkYXksIGZhbHNlKTtcbiAgICAgIHRySFRNTCArPSBidWlsZFRkRWxlbSgnY29sb3InLCB2YWx1ZS5jb2xvciwgZmFsc2UpO1xuICAgICAgdHJIVE1MICs9ICc8L3RyPic7XG4gICAgfVxuICAgIHJldHVybiB0ckhUTUw7XG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBzZW5kRmlsZVJlcXVlc3QocmVxKSB7XG4gICAgcmV0dXJuIGZldGNoKHJlcSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBpZihyZXMub2spIHtcbiAgICAgICAgbGV0IGNvbnRlbnRUeXBlID0gcmVzLmhlYWRlcnMuZ2V0KCdDb250ZW50LVR5cGUnKTtcbiAgICAgICAgaWYoY29udGVudFR5cGUgJiYgY29udGVudFR5cGUuaW5jbHVkZXMoJ2FwcGxpY2F0aW9uL2pzb24nKSkge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnVW5leHBlY3RlZCBDb250ZW50LVR5cGUnKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdSZXNwb25zZSBub3QgMjAwIC0gMjk5Jyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBmaWxlU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICBpZiAoZmlsZVNlbGVjdCkge1xuICAgICAgZmlsZUlucHV0LmNsaWNrKCk7XG4gICAgfVxuICB9KTtcblxuICBicm93c2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgIGlmIChmaWxlSW5wdXQpIHtcbiAgICAgIGZpbGVJbnB1dC5jbGljaygpO1xuICAgIH1cbiAgfSk7XG5cbiAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGFzeW5jIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGxldCBkYXRhID0gbmV3IEZvcm1EYXRhKClcbiAgICBkYXRhLmFwcGVuZChcImNzdlwiLCBmaWxlSW5wdXQuZmlsZXNbMF0pO1xuICAgIGNvbnN0IHJlcSA9IG5ldyBSZXF1ZXN0KCcvdXBsb2FkJywge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBib2R5OiBkYXRhXG4gICAgfSk7XG5cbiAgICAvLyBpbnNlcnQgdGhlIG5hbWUgb2YgdGhlIGZpbGUgbGFzdCBzZW50IGludG8gdGhlIGZpbGVTZWxlY3QgZWxlbWVudFxuICAgIGZpbGVTZWxlY3QuaW5uZXJIVE1MID0gZmlsZUlucHV0LmZpbGVzWzBdLm5hbWU7XG4gICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG5cbiAgICB0YWJsZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc29ydGFibGUtaW5pdGlhbGl6ZWQnLCBmYWxzZSk7XG4gICAgcmVzZXRTb3J0U3RhdHVzKHRhYmxlSGVhZGVyRWxlbWVudHMpO1xuXG4gICAgc2VuZEZpbGVSZXF1ZXN0KHJlcSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBsZXQgdHJIVE1MID0gY29uc3RydWN0Um93cyhyZXMpXG4gICAgICB0YWJsZUJvZHkuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCB0ckhUTUwpO1xuICAgICAgU29ydGFibGUuaW5pdCgpO1xuXG4gICAgICBjb25zdCByb3dzID0gdGFibGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0Ym9keVwiKVswXS5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRyXCIpLmxlbmd0aDtcbiAgICAgIHBlb3BsZUNvdW50LmlubmVySFRNTCA9IHJvd3M7XG4gICAgfSlcbiAgICAuY2F0Y2goKGUpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGUpO1xuICAgIH0pO1xuICB9KTtcbn0pKCk7Il19
