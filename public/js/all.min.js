/*
Copyright (C) 2013 Adam Schwartz, http://adamschwartz.co

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/

(function () {
  var SELECTOR, addEventListener, clickEvents, numberRegExp, sortable, touchDevice, trimRegExp;

  SELECTOR = 'table[data-sortable]';

  numberRegExp = /^-?[Â£$Â¤]?[\d,.]+%?$/;

  trimRegExp = /^\s+|\s+$/g;

  clickEvents = ['click'];

  touchDevice = 'ontouchstart' in document.documentElement;

  if (touchDevice) {
    clickEvents.push('touchstart');
  }

  addEventListener = function addEventListener(el, event, handler) {
    if (el.addEventListener != null) {
      return el.addEventListener(event, handler, false);
    } else {
      return el.attachEvent("on" + event, handler);
    }
  };

  sortable = {
    init: function init(options) {
      var table, tables, _i, _len, _results;
      if (options == null) {
        options = {};
      }
      if (options.selector == null) {
        options.selector = SELECTOR;
      }
      tables = document.querySelectorAll(options.selector);
      _results = [];
      for (_i = 0, _len = tables.length; _i < _len; _i++) {
        table = tables[_i];
        _results.push(sortable.initTable(table));
      }
      return _results;
    },
    initTable: function initTable(table) {
      var i, th, ths, _i, _len, _ref;
      if (((_ref = table.tHead) != null ? _ref.rows.length : void 0) !== 1) {
        return;
      }
      if (table.getAttribute('data-sortable-initialized') === 'true') {
        return;
      }
      table.setAttribute('data-sortable-initialized', 'true');
      ths = table.querySelectorAll('th');
      for (i = _i = 0, _len = ths.length; _i < _len; i = ++_i) {
        th = ths[i];
        if (th.getAttribute('data-sortable') !== 'false') {
          sortable.setupClickableTH(table, th, i);
        }
      }
      return table;
    },
    setupClickableTH: function setupClickableTH(table, th, i) {
      var eventName, onClick, type, _i, _len, _results;
      type = sortable.getColumnType(table, i);
      onClick = function onClick(e) {
        var compare, item, newSortedDirection, position, row, rowArray, sorted, sortedDirection, tBody, ths, value, _compare, _i, _j, _k, _l, _len, _len1, _len2, _len3, _len4, _m, _ref, _ref1;
        if (e.handled !== true) {
          e.handled = true;
        } else {
          return false;
        }
        sorted = this.getAttribute('data-sorted') === 'true';
        sortedDirection = this.getAttribute('data-sorted-direction');
        if (sorted) {
          newSortedDirection = sortedDirection === 'ascending' ? 'descending' : 'ascending';
        } else {
          newSortedDirection = type.defaultSortDirection;
        }
        ths = this.parentNode.querySelectorAll('th');
        for (_i = 0, _len = ths.length; _i < _len; _i++) {
          th = ths[_i];
          th.setAttribute('data-sorted', 'false');
          th.removeAttribute('data-sorted-direction');
        }
        this.setAttribute('data-sorted', 'true');
        this.setAttribute('data-sorted-direction', newSortedDirection);
        tBody = table.tBodies[0];
        rowArray = [];
        if (!sorted) {
          if (type.compare != null) {
            _compare = type.compare;
          } else {
            _compare = function _compare(a, b) {
              return b - a;
            };
          }
          compare = function compare(a, b) {
            if (a[0] === b[0]) {
              return a[2] - b[2];
            }
            if (type.reverse) {
              return _compare(b[0], a[0]);
            } else {
              return _compare(a[0], b[0]);
            }
          };
          _ref = tBody.rows;
          for (position = _j = 0, _len1 = _ref.length; _j < _len1; position = ++_j) {
            row = _ref[position];
            value = sortable.getNodeValue(row.cells[i]);
            if (type.comparator != null) {
              value = type.comparator(value);
            }
            rowArray.push([value, row, position]);
          }
          rowArray.sort(compare);
          for (_k = 0, _len2 = rowArray.length; _k < _len2; _k++) {
            row = rowArray[_k];
            tBody.appendChild(row[1]);
          }
        } else {
          _ref1 = tBody.rows;
          for (_l = 0, _len3 = _ref1.length; _l < _len3; _l++) {
            item = _ref1[_l];
            rowArray.push(item);
          }
          rowArray.reverse();
          for (_m = 0, _len4 = rowArray.length; _m < _len4; _m++) {
            row = rowArray[_m];
            tBody.appendChild(row);
          }
        }
        if (typeof window['CustomEvent'] === 'function') {
          return typeof table.dispatchEvent === "function" ? table.dispatchEvent(new CustomEvent('Sortable.sorted', {
            bubbles: true
          })) : void 0;
        }
      };
      _results = [];
      for (_i = 0, _len = clickEvents.length; _i < _len; _i++) {
        eventName = clickEvents[_i];
        _results.push(addEventListener(th, eventName, onClick));
      }
      return _results;
    },
    getColumnType: function getColumnType(table, i) {
      var row, specified, text, type, _i, _j, _len, _len1, _ref, _ref1, _ref2;
      specified = (_ref = table.querySelectorAll('th')[i]) != null ? _ref.getAttribute('data-sortable-type') : void 0;
      if (specified != null) {
        return sortable.typesObject[specified];
      }
      _ref1 = table.tBodies[0].rows;
      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
        row = _ref1[_i];
        text = sortable.getNodeValue(row.cells[i]);
        _ref2 = sortable.types;
        for (_j = 0, _len1 = _ref2.length; _j < _len1; _j++) {
          type = _ref2[_j];
          if (type.match(text)) {
            return type;
          }
        }
      }
      return sortable.typesObject.alpha;
    },
    getNodeValue: function getNodeValue(node) {
      var dataValue;
      if (!node) {
        return '';
      }
      dataValue = node.getAttribute('data-value');
      if (dataValue !== null) {
        return dataValue;
      }
      if (typeof node.innerText !== 'undefined') {
        return node.innerText.replace(trimRegExp, '');
      }
      return node.textContent.replace(trimRegExp, '');
    },
    setupTypes: function setupTypes(types) {
      var type, _i, _len, _results;
      sortable.types = types;
      sortable.typesObject = {};
      _results = [];
      for (_i = 0, _len = types.length; _i < _len; _i++) {
        type = types[_i];
        _results.push(sortable.typesObject[type.name] = type);
      }
      return _results;
    }
  };

  sortable.setupTypes([{
    name: 'numeric',
    defaultSortDirection: 'descending',
    match: function match(a) {
      return a.match(numberRegExp);
    },
    comparator: function comparator(a) {
      return parseFloat(a.replace(/[^0-9.-]/g, ''), 10) || 0;
    }
  }, {
    name: 'date',
    defaultSortDirection: 'ascending',
    reverse: true,
    match: function match(a) {
      // never match unless explicitly told to run a date through attribute settings
      return false;
    },
    comparator: function comparator(a) {
      var aArray = a.split('/');
      // ISO = YYYY MM DD - remember that months are 0 based
      var dateA = new Date(aArray[2], aArray[0] - 1, aArray[1]);
      return dateA || 0;
    }
  }, {
    name: 'alpha',
    defaultSortDirection: 'ascending',
    match: function match() {
      return true;
    },
    compare: function compare(a, b) {
      return a.localeCompare(b);
    }
  }]);

  setTimeout(sortable.init, 0);

  if (typeof define === 'function' && define.amd) {
    define(function () {
      return sortable;
    });
  } else if (typeof exports !== 'undefined') {
    module.exports = sortable;
  } else {
    window.Sortable = sortable;
  }
}).call(this);
(function () {
  var fileSelect = document.getElementById('fileSelect');
  var fileInput = document.getElementById('fileInput');
  var browse = document.getElementById('browse');
  var table = document.getElementById('people');
  var tableBody = document.getElementById('people-body');
  var tableHeaderElements = document.getElementsByTagName('th');
  var peopleCount = document.getElementById('peopleCount');

  function resetSortStatus(elements) {
    for (var i = 0; i < elements.length; i++) {
      elements[i].removeAttribute('data-sorted');
      elements[i].removeAttribute('data-sorted-direction');
    }
  }

  function buildTdElem(type, value, image) {
    if (image) {
      return '<td class="i"><span class="' + type + '"></span>' + value + '</td>';
    } else {
      return '<td class="' + type + '">' + value + '</td>';
    }
  }

  fileSelect.addEventListener('click', function (e) {
    if (fileSelect) {
      fileInput.click();
    }
  });

  browse.addEventListener('click', function (e) {
    if (fileInput) {
      fileInput.click();
    }
  });

  fileInput.addEventListener('change', function (e) {
    e.preventDefault();
    data = new FormData();
    data.append("csv", fileInput.files[0]);
    var req = new Request('/upload', {
      method: 'POST',
      body: data
    });

    // insert the name of the file last sent into the fileSelect element
    fileSelect.innerHTML = fileInput.files[0].name;
    fileInput.value = '';

    fetch(req).then(function (res) {
      if (res.ok) {
        contentType = res.headers.get('Content-Type');
        if (contentType && contentType.includes('application/json')) {
          return res.json();
        }
      }
    }).then(function (data) {
      table.setAttribute('data-sortable-initialized', false);
      resetSortStatus(tableHeaderElements);
      var trHTML = '';
      data.forEach(function (value) {
        trHTML += '<tr>';
        trHTML += buildTdElem('last', value.last, false);
        trHTML += buildTdElem('first', value.first, false);
        if (value.m === 'None') {
          trHTML += buildTdElem('none', value.m, false);
        } else {
          trHTML += buildTdElem('m', value.m, false);
        }
        trHTML += buildTdElem(value.pet.toLowerCase(), value.pet, true);
        trHTML += buildTdElem('birthday', value.birthday, false);
        trHTML += buildTdElem('color', value.color, false);
        trHTML += '</tr>';
      });
      tableBody.insertAdjacentHTML('beforeend', trHTML);
      Sortable.init();

      var rows = table.getElementsByTagName("tbody")[0].getElementsByTagName("tr").length;
      peopleCount.innerHTML = rows;
    }).catch(function (err) {
      console.log(err);
    });
  }, false);
})();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvcnRhYmxlLmpzIiwiYXBwLmpzIl0sIm5hbWVzIjpbIlNFTEVDVE9SIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsaWNrRXZlbnRzIiwibnVtYmVyUmVnRXhwIiwic29ydGFibGUiLCJ0b3VjaERldmljZSIsInRyaW1SZWdFeHAiLCJkb2N1bWVudCIsImRvY3VtZW50RWxlbWVudCIsInB1c2giLCJlbCIsImV2ZW50IiwiaGFuZGxlciIsImF0dGFjaEV2ZW50IiwiaW5pdCIsIm9wdGlvbnMiLCJ0YWJsZSIsInRhYmxlcyIsIl9pIiwiX2xlbiIsIl9yZXN1bHRzIiwic2VsZWN0b3IiLCJxdWVyeVNlbGVjdG9yQWxsIiwibGVuZ3RoIiwiaW5pdFRhYmxlIiwiaSIsInRoIiwidGhzIiwiX3JlZiIsInRIZWFkIiwicm93cyIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInNldHVwQ2xpY2thYmxlVEgiLCJldmVudE5hbWUiLCJvbkNsaWNrIiwidHlwZSIsImdldENvbHVtblR5cGUiLCJlIiwiY29tcGFyZSIsIml0ZW0iLCJuZXdTb3J0ZWREaXJlY3Rpb24iLCJwb3NpdGlvbiIsInJvdyIsInJvd0FycmF5Iiwic29ydGVkIiwic29ydGVkRGlyZWN0aW9uIiwidEJvZHkiLCJ2YWx1ZSIsIl9jb21wYXJlIiwiX2oiLCJfayIsIl9sIiwiX2xlbjEiLCJfbGVuMiIsIl9sZW4zIiwiX2xlbjQiLCJfbSIsIl9yZWYxIiwiaGFuZGxlZCIsImRlZmF1bHRTb3J0RGlyZWN0aW9uIiwicGFyZW50Tm9kZSIsInJlbW92ZUF0dHJpYnV0ZSIsInRCb2RpZXMiLCJhIiwiYiIsInJldmVyc2UiLCJnZXROb2RlVmFsdWUiLCJjZWxscyIsImNvbXBhcmF0b3IiLCJzb3J0IiwiYXBwZW5kQ2hpbGQiLCJ3aW5kb3ciLCJkaXNwYXRjaEV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJidWJibGVzIiwic3BlY2lmaWVkIiwidGV4dCIsIl9yZWYyIiwidHlwZXNPYmplY3QiLCJ0eXBlcyIsIm1hdGNoIiwiYWxwaGEiLCJub2RlIiwiZGF0YVZhbHVlIiwiaW5uZXJUZXh0IiwicmVwbGFjZSIsInRleHRDb250ZW50Iiwic2V0dXBUeXBlcyIsIm5hbWUiLCJwYXJzZUZsb2F0IiwiYUFycmF5Iiwic3BsaXQiLCJkYXRlQSIsIkRhdGUiLCJsb2NhbGVDb21wYXJlIiwic2V0VGltZW91dCIsImRlZmluZSIsImFtZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJTb3J0YWJsZSIsImNhbGwiLCJmaWxlU2VsZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmaWxlSW5wdXQiLCJicm93c2UiLCJ0YWJsZUJvZHkiLCJ0YWJsZUhlYWRlckVsZW1lbnRzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJwZW9wbGVDb3VudCIsInJlc2V0U29ydFN0YXR1cyIsImVsZW1lbnRzIiwiYnVpbGRUZEVsZW0iLCJpbWFnZSIsImNsaWNrIiwicHJldmVudERlZmF1bHQiLCJkYXRhIiwiRm9ybURhdGEiLCJhcHBlbmQiLCJmaWxlcyIsInJlcSIsIlJlcXVlc3QiLCJtZXRob2QiLCJib2R5IiwiaW5uZXJIVE1MIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJjb250ZW50VHlwZSIsImhlYWRlcnMiLCJnZXQiLCJpbmNsdWRlcyIsImpzb24iLCJ0ckhUTUwiLCJmb3JFYWNoIiwibGFzdCIsImZpcnN0IiwibSIsInBldCIsInRvTG93ZXJDYXNlIiwiYmlydGhkYXkiLCJjb2xvciIsImluc2VydEFkamFjZW50SFRNTCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFzQkEsQ0FBQyxZQUFXO0FBQ1YsTUFBSUEsUUFBSixFQUFjQyxnQkFBZCxFQUFnQ0MsV0FBaEMsRUFBNkNDLFlBQTdDLEVBQTJEQyxRQUEzRCxFQUFxRUMsV0FBckUsRUFBa0ZDLFVBQWxGOztBQUVBTixhQUFXLHNCQUFYOztBQUVBRyxpQkFBZSx1QkFBZjs7QUFFQUcsZUFBYSxZQUFiOztBQUVB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MUM7QUFDQWxDLGVBQVN2RixJQUFUOztBQUVBLFVBQU1nQixPQUFPZCxNQUFNNkYsb0JBQU4sQ0FBMkIsT0FBM0IsRUFBb0MsQ0FBcEMsRUFBdUNBLG9CQUF2QyxDQUE0RCxJQUE1RCxFQUFrRXRGLE1BQS9FO0FBQ0F1RixrQkFBWWUsU0FBWixHQUF3Qi9GLElBQXhCO0FBQ0QsS0FoQ0QsRUFpQ0NtSCxLQWpDRCxDQWlDTyxVQUFDQyxHQUFELEVBQVM7QUFBRUMsY0FBUUMsR0FBUixDQUFZRixHQUFaO0FBQW1CLEtBakNyQztBQWtDRCxHQS9DRCxFQStDRyxLQS9DSDtBQWdERCxDQXBGRCIsImZpbGUiOiJhbGwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAoQykgMjAxMyBBZGFtIFNjaHdhcnR6LCBodHRwOi8vYWRhbXNjaHdhcnR6LmNvXG5cblBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbm9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbmluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbnRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbmNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbmFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG5JTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbkZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbk9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cblRIRSBTT0ZUV0FSRS5cbiovXG5cbihmdW5jdGlvbigpIHtcbiAgdmFyIFNFTEVDVE9SLCBhZGRFdmVudExpc3RlbmVyLCBjbGlja0V2ZW50cywgbnVtYmVyUmVnRXhwLCBzb3J0YWJsZSwgdG91Y2hEZXZpY2UsIHRyaW1SZWdFeHA7XG5cbiAgU0VMRUNUT1IgPSAndGFibGVbZGF0YS1zb3J0YWJsZV0nO1xuXG4gIG51bWJlclJlZ0V4cCA9IC9eLT9bw4LCoyTDgsKkXT9bXFxkLC5dKyU/JC87XG5cbiAgdHJpbVJlZ0V4cCA9IC9eXFxzK3xcXHMrJC9nO1xuXG4gIGNsaWNrRXZlbnRzID0gWydjbGljayddO1xuXG4gIHRvdWNoRGV2aWNlID0gJ29udG91Y2hzdGFydCcgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuXG4gIGlmICh0b3VjaERldmljZSkge1xuICAgIGNsaWNrRXZlbnRzLnB1c2goJ3RvdWNoc3RhcnQnKTtcbiAgfVxuXG4gIGFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihlbCwgZXZlbnQsIGhhbmRsZXIpIHtcbiAgICBpZiAoZWwuYWRkRXZlbnRMaXN0ZW5lciAhPSBudWxsKSB7XG4gICAgICByZXR1cm4gZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgZmFsc2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZWwuYXR0YWNoRXZlbnQoXCJvblwiICsgZXZlbnQsIGhhbmRsZXIpO1xuICAgIH1cbiAgfTtcblxuICBzb3J0YWJsZSA9IHtcbiAgICBpbml0OiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICB2YXIgdGFibGUsIHRhYmxlcywgX2ksIF9sZW4sIF9yZXN1bHRzO1xuICAgICAgaWYgKG9wdGlvbnMgPT0gbnVsbCkge1xuICAgICAgICBvcHRpb25zID0ge307XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy5zZWxlY3RvciA9PSBudWxsKSB7XG4gICAgICAgIG9wdGlvbnMuc2VsZWN0b3IgPSBTRUxFQ1RPUjtcbiAgICAgIH1cbiAgICAgIHRhYmxlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwob3B0aW9ucy5zZWxlY3Rvcik7XG4gICAgICBfcmVzdWx0cyA9IFtdO1xuICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSB0YWJsZXMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcbiAgICAgICAgdGFibGUgPSB0YWJsZXNbX2ldO1xuICAgICAgICBfcmVzdWx0cy5wdXNoKHNvcnRhYmxlLmluaXRUYWJsZSh0YWJsZSkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIF9yZXN1bHRzO1xuICAgIH0sXG4gICAgaW5pdFRhYmxlOiBmdW5jdGlvbih0YWJsZSkge1xuICAgICAgdmFyIGksIHRoLCB0aHMsIF9pLCBfbGVuLCBfcmVmO1xuICAgICAgaWYgKCgoX3JlZiA9IHRhYmxlLnRIZWFkKSAhPSBudWxsID8gX3JlZi5yb3dzLmxlbmd0aCA6IHZvaWQgMCkgIT09IDEpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHRhYmxlLmdldEF0dHJpYnV0ZSgnZGF0YS1zb3J0YWJsZS1pbml0aWFsaXplZCcpID09PSAndHJ1ZScpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGFibGUuc2V0QXR0cmlidXRlKCdkYXRhLXNvcnRhYmxlLWluaXRpYWxpemVkJywgJ3RydWUnKTtcbiAgICAgIHRocyA9IHRhYmxlLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoJyk7XG4gICAgICBmb3IgKGkgPSBfaSA9IDAsIF9sZW4gPSB0aHMubGVuZ3RoOyBfaSA8IF9sZW47IGkgPSArK19pKSB7XG4gICAgICAgIHRoID0gdGhzW2ldO1xuICAgICAgICBpZiAodGguZ2V0QXR0cmlidXRlKCdkYXRhLXNvcnRhYmxlJykgIT09ICdmYWxzZScpIHtcbiAgICAgICAgICBzb3J0YWJsZS5zZXR1cENsaWNrYWJsZVRIKHRhYmxlLCB0aCwgaSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0YWJsZTtcbiAgICB9LFxuICAgIHNldHVwQ2xpY2thYmxlVEg6IGZ1bmN0aW9uKHRhYmxlLCB0aCwgaSkge1xuICAgICAgdmFyIGV2ZW50TmFtZSwgb25DbGljaywgdHlwZSwgX2ksIF9sZW4sIF9yZXN1bHRzO1xuICAgICAgdHlwZSA9IHNvcnRhYmxlLmdldENvbHVtblR5cGUodGFibGUsIGkpO1xuICAgICAgb25DbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIGNvbXBhcmUsIGl0ZW0sIG5ld1NvcnRlZERpcmVjdGlvbiwgcG9zaXRpb24sIHJvdywgcm93QXJyYXksIHNvcnRlZCwgc29ydGVkRGlyZWN0aW9uLCB0Qm9keSwgdGhzLCB2YWx1ZSwgX2NvbXBhcmUsIF9pLCBfaiwgX2ssIF9sLCBfbGVuLCBfbGVuMSwgX2xlbjIsIF9sZW4zLCBfbGVuNCwgX20sIF9yZWYsIF9yZWYxO1xuICAgICAgICBpZiAoZS5oYW5kbGVkICE9PSB0cnVlKSB7XG4gICAgICAgICAgZS5oYW5kbGVkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgc29ydGVkID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtc29ydGVkJykgPT09ICd0cnVlJztcbiAgICAgICAgc29ydGVkRGlyZWN0aW9uID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtc29ydGVkLWRpcmVjdGlvbicpO1xuICAgICAgICBpZiAoc29ydGVkKSB7XG4gICAgICAgICAgbmV3U29ydGVkRGlyZWN0aW9uID0gc29ydGVkRGlyZWN0aW9uID09PSAnYXNjZW5kaW5nJyA/ICdkZXNjZW5kaW5nJyA6ICdhc2NlbmRpbmcnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld1NvcnRlZERpcmVjdGlvbiA9IHR5cGUuZGVmYXVsdFNvcnREaXJlY3Rpb247XG4gICAgICAgIH1cbiAgICAgICAgdGhzID0gdGhpcy5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoJyk7XG4gICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gdGhzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XG4gICAgICAgICAgdGggPSB0aHNbX2ldO1xuICAgICAgICAgIHRoLnNldEF0dHJpYnV0ZSgnZGF0YS1zb3J0ZWQnLCAnZmFsc2UnKTtcbiAgICAgICAgICB0aC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc29ydGVkLWRpcmVjdGlvbicpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKCdkYXRhLXNvcnRlZCcsICd0cnVlJyk7XG4gICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKCdkYXRhLXNvcnRlZC1kaXJlY3Rpb24nLCBuZXdTb3J0ZWREaXJlY3Rpb24pO1xuICAgICAgICB0Qm9keSA9IHRhYmxlLnRCb2RpZXNbMF07XG4gICAgICAgIHJvd0FycmF5ID0gW107XG4gICAgICAgIGlmICghc29ydGVkKSB7XG4gICAgICAgICAgaWYgKHR5cGUuY29tcGFyZSAhPSBudWxsKSB7XG4gICAgICAgICAgICBfY29tcGFyZSA9IHR5cGUuY29tcGFyZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX2NvbXBhcmUgPSBmdW5jdGlvbihhLCBiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBiIC0gYTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbXBhcmUgPSBmdW5jdGlvbihhLCBiKSB7XG4gICAgICAgICAgICBpZiAoYVswXSA9PT0gYlswXSkge1xuICAgICAgICAgICAgICByZXR1cm4gYVsyXSAtIGJbMl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZS5yZXZlcnNlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBfY29tcGFyZShiWzBdLCBhWzBdKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBfY29tcGFyZShhWzBdLCBiWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICAgIF9yZWYgPSB0Qm9keS5yb3dzO1xuICAgICAgICAgIGZvciAocG9zaXRpb24gPSBfaiA9IDAsIF9sZW4xID0gX3JlZi5sZW5ndGg7IF9qIDwgX2xlbjE7IHBvc2l0aW9uID0gKytfaikge1xuICAgICAgICAgICAgcm93ID0gX3JlZltwb3NpdGlvbl07XG4gICAgICAgICAgICB2YWx1ZSA9IHNvcnRhYmxlLmdldE5vZGVWYWx1ZShyb3cuY2VsbHNbaV0pO1xuICAgICAgICAgICAgaWYgKHR5cGUuY29tcGFyYXRvciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIHZhbHVlID0gdHlwZS5jb21wYXJhdG9yKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJvd0FycmF5LnB1c2goW3ZhbHVlLCByb3csIHBvc2l0aW9uXSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJvd0FycmF5LnNvcnQoY29tcGFyZSk7XG4gICAgICAgICAgZm9yIChfayA9IDAsIF9sZW4yID0gcm93QXJyYXkubGVuZ3RoOyBfayA8IF9sZW4yOyBfaysrKSB7XG4gICAgICAgICAgICByb3cgPSByb3dBcnJheVtfa107XG4gICAgICAgICAgICB0Qm9keS5hcHBlbmRDaGlsZChyb3dbMV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfcmVmMSA9IHRCb2R5LnJvd3M7XG4gICAgICAgICAgZm9yIChfbCA9IDAsIF9sZW4zID0gX3JlZjEubGVuZ3RoOyBfbCA8IF9sZW4zOyBfbCsrKSB7XG4gICAgICAgICAgICBpdGVtID0gX3JlZjFbX2xdO1xuICAgICAgICAgICAgcm93QXJyYXkucHVzaChpdGVtKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcm93QXJyYXkucmV2ZXJzZSgpO1xuICAgICAgICAgIGZvciAoX20gPSAwLCBfbGVuNCA9IHJvd0FycmF5Lmxlbmd0aDsgX20gPCBfbGVuNDsgX20rKykge1xuICAgICAgICAgICAgcm93ID0gcm93QXJyYXlbX21dO1xuICAgICAgICAgICAgdEJvZHkuYXBwZW5kQ2hpbGQocm93KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3dbJ0N1c3RvbUV2ZW50J10gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICByZXR1cm4gdHlwZW9mIHRhYmxlLmRpc3BhdGNoRXZlbnQgPT09IFwiZnVuY3Rpb25cIiA/IHRhYmxlLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdTb3J0YWJsZS5zb3J0ZWQnLCB7XG4gICAgICAgICAgICBidWJibGVzOiB0cnVlXG4gICAgICAgICAgfSkpIDogdm9pZCAwO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgX3Jlc3VsdHMgPSBbXTtcbiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gY2xpY2tFdmVudHMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcbiAgICAgICAgZXZlbnROYW1lID0gY2xpY2tFdmVudHNbX2ldO1xuICAgICAgICBfcmVzdWx0cy5wdXNoKGFkZEV2ZW50TGlzdGVuZXIodGgsIGV2ZW50TmFtZSwgb25DbGljaykpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIF9yZXN1bHRzO1xuICAgIH0sXG4gICAgZ2V0Q29sdW1uVHlwZTogZnVuY3Rpb24odGFibGUsIGkpIHtcbiAgICAgIHZhciByb3csIHNwZWNpZmllZCwgdGV4dCwgdHlwZSwgX2ksIF9qLCBfbGVuLCBfbGVuMSwgX3JlZiwgX3JlZjEsIF9yZWYyO1xuICAgICAgc3BlY2lmaWVkID0gKF9yZWYgPSB0YWJsZS5xdWVyeVNlbGVjdG9yQWxsKCd0aCcpW2ldKSAhPSBudWxsID8gX3JlZi5nZXRBdHRyaWJ1dGUoJ2RhdGEtc29ydGFibGUtdHlwZScpIDogdm9pZCAwO1xuICAgICAgaWYgKHNwZWNpZmllZCAhPSBudWxsKSB7XG4gICAgICAgIHJldHVybiBzb3J0YWJsZS50eXBlc09iamVjdFtzcGVjaWZpZWRdO1xuICAgICAgfVxuICAgICAgX3JlZjEgPSB0YWJsZS50Qm9kaWVzWzBdLnJvd3M7XG4gICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYxLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XG4gICAgICAgIHJvdyA9IF9yZWYxW19pXTtcbiAgICAgICAgdGV4dCA9IHNvcnRhYmxlLmdldE5vZGVWYWx1ZShyb3cuY2VsbHNbaV0pO1xuICAgICAgICBfcmVmMiA9IHNvcnRhYmxlLnR5cGVzO1xuICAgICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmMi5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHtcbiAgICAgICAgICB0eXBlID0gX3JlZjJbX2pdO1xuICAgICAgICAgIGlmICh0eXBlLm1hdGNoKHRleHQpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHlwZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBzb3J0YWJsZS50eXBlc09iamVjdC5hbHBoYTtcbiAgICB9LFxuICAgIGdldE5vZGVWYWx1ZTogZnVuY3Rpb24obm9kZSkge1xuICAgICAgdmFyIGRhdGFWYWx1ZTtcbiAgICAgIGlmICghbm9kZSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG4gICAgICBkYXRhVmFsdWUgPSBub2RlLmdldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScpO1xuICAgICAgaWYgKGRhdGFWYWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gZGF0YVZhbHVlO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBub2RlLmlubmVyVGV4dCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUuaW5uZXJUZXh0LnJlcGxhY2UodHJpbVJlZ0V4cCwgJycpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5vZGUudGV4dENvbnRlbnQucmVwbGFjZSh0cmltUmVnRXhwLCAnJyk7XG4gICAgfSxcbiAgICBzZXR1cFR5cGVzOiBmdW5jdGlvbih0eXBlcykge1xuICAgICAgdmFyIHR5cGUsIF9pLCBfbGVuLCBfcmVzdWx0cztcbiAgICAgIHNvcnRhYmxlLnR5cGVzID0gdHlwZXM7XG4gICAgICBzb3J0YWJsZS50eXBlc09iamVjdCA9IHt9O1xuICAgICAgX3Jlc3VsdHMgPSBbXTtcbiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gdHlwZXMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcbiAgICAgICAgdHlwZSA9IHR5cGVzW19pXTtcbiAgICAgICAgX3Jlc3VsdHMucHVzaChzb3J0YWJsZS50eXBlc09iamVjdFt0eXBlLm5hbWVdID0gdHlwZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gX3Jlc3VsdHM7XG4gICAgfVxuICB9O1xuXG4gIHNvcnRhYmxlLnNldHVwVHlwZXMoW1xuICAgIHtcbiAgICAgIG5hbWU6ICdudW1lcmljJyxcbiAgICAgIGRlZmF1bHRTb3J0RGlyZWN0aW9uOiAnZGVzY2VuZGluZycsXG4gICAgICBtYXRjaDogZnVuY3Rpb24oYSkge1xuICAgICAgICByZXR1cm4gYS5tYXRjaChudW1iZXJSZWdFeHApO1xuICAgICAgfSxcbiAgICAgIGNvbXBhcmF0b3I6IGZ1bmN0aW9uKGEpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoYS5yZXBsYWNlKC9bXjAtOS4tXS9nLCAnJyksIDEwKSB8fCAwO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIG5hbWU6ICdkYXRlJyxcbiAgICAgIGRlZmF1bHRTb3J0RGlyZWN0aW9uOiAnYXNjZW5kaW5nJyxcbiAgICAgIHJldmVyc2U6IHRydWUsXG4gICAgICBtYXRjaDogZnVuY3Rpb24oYSkge1xuICAgICAgICAvLyBuZXZlciBtYXRjaCB1bmxlc3MgZXhwbGljaXRseSB0b2xkIHRvIHJ1biBhIGRhdGUgdGhyb3VnaCBhdHRyaWJ1dGUgc2V0dGluZ3NcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSxcbiAgICAgIGNvbXBhcmF0b3I6IGZ1bmN0aW9uKGEpIHtcbiAgICAgICAgdmFyIGFBcnJheSA9IGEuc3BsaXQoJy8nKTtcbiAgICAgICAgLy8gSVNPID0gWVlZWSBNTSBERCAtIHJlbWVtYmVyIHRoYXQgbW9udGhzIGFyZSAwIGJhc2VkXG4gICAgICAgIHZhciBkYXRlQSA9IG5ldyBEYXRlKGFBcnJheVsyXSwgYUFycmF5WzBdIC0gMSwgYUFycmF5WzFdKTtcbiAgICAgICAgcmV0dXJuIGRhdGVBIHx8IDA7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAgbmFtZTogJ2FscGhhJyxcbiAgICAgIGRlZmF1bHRTb3J0RGlyZWN0aW9uOiAnYXNjZW5kaW5nJyxcbiAgICAgIG1hdGNoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9LFxuICAgICAgY29tcGFyZTogZnVuY3Rpb24oYSwgYikge1xuICAgICAgICByZXR1cm4gYS5sb2NhbGVDb21wYXJlKGIpO1xuICAgICAgfVxuICAgIH1cbiAgXSk7XG5cbiAgc2V0VGltZW91dChzb3J0YWJsZS5pbml0LCAwKTtcblxuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHNvcnRhYmxlO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gc29ydGFibGU7XG4gIH0gZWxzZSB7XG4gICAgd2luZG93LlNvcnRhYmxlID0gc29ydGFibGU7XG4gIH1cblxufSkuY2FsbCh0aGlzKTtcbiIsIigoKSA9PiB7XG4gIGNvbnN0IGZpbGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZVNlbGVjdCcpO1xuICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUlucHV0Jyk7XG4gIGNvbnN0IGJyb3dzZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicm93c2UnKTtcbiAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGVvcGxlJyk7XG4gIGNvbnN0IHRhYmxlQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZW9wbGUtYm9keScpO1xuICBjb25zdCB0YWJsZUhlYWRlckVsZW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RoJylcbiAgY29uc3QgcGVvcGxlQ291bnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGVvcGxlQ291bnQnKTtcblxuICBmdW5jdGlvbiByZXNldFNvcnRTdGF0dXMoZWxlbWVudHMpIHtcbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGVsZW1lbnRzW2ldLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1zb3J0ZWQnKTtcbiAgICAgIGVsZW1lbnRzW2ldLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1zb3J0ZWQtZGlyZWN0aW9uJyk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gYnVpbGRUZEVsZW0odHlwZSwgdmFsdWUsIGltYWdlKSB7XG4gICAgaWYoaW1hZ2UpIHtcbiAgICAgIHJldHVybiAnPHRkIGNsYXNzPVwiaVwiPjxzcGFuIGNsYXNzPVwiJyArIHR5cGUgKyAnXCI+PC9zcGFuPicgKyB2YWx1ZSArICc8L3RkPic7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnPHRkIGNsYXNzPVwiJyArIHR5cGUgKyAnXCI+JyArIHZhbHVlICsgJzwvdGQ+JztcbiAgICB9XG4gIH1cblxuICBmaWxlU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICBpZiAoZmlsZVNlbGVjdCkge1xuICAgICAgZmlsZUlucHV0LmNsaWNrKCk7XG4gICAgfVxuICB9KTtcblxuICBicm93c2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgIGlmIChmaWxlSW5wdXQpIHtcbiAgICAgIGZpbGVJbnB1dC5jbGljaygpO1xuICAgIH1cbiAgfSk7XG5cbiAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGRhdGEgPSBuZXcgRm9ybURhdGEoKVxuICAgIGRhdGEuYXBwZW5kKFwiY3N2XCIsIGZpbGVJbnB1dC5maWxlc1swXSk7XG4gICAgY29uc3QgcmVxID0gbmV3IFJlcXVlc3QoJy91cGxvYWQnLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGJvZHk6IGRhdGFcbiAgICB9KTtcblxuICAgIC8vIGluc2VydCB0aGUgbmFtZSBvZiB0aGUgZmlsZSBsYXN0IHNlbnQgaW50byB0aGUgZmlsZVNlbGVjdCBlbGVtZW50XG4gICAgZmlsZVNlbGVjdC5pbm5lckhUTUwgPSBmaWxlSW5wdXQuZmlsZXNbMF0ubmFtZTtcbiAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcblxuICAgIGZldGNoKHJlcSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBpZihyZXMub2spIHtcbiAgICAgICAgY29udGVudFR5cGUgPSByZXMuaGVhZGVycy5nZXQoJ0NvbnRlbnQtVHlwZScpO1xuICAgICAgICBpZihjb250ZW50VHlwZSAmJiBjb250ZW50VHlwZS5pbmNsdWRlcygnYXBwbGljYXRpb24vanNvbicpKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICB0YWJsZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc29ydGFibGUtaW5pdGlhbGl6ZWQnLCBmYWxzZSk7XG4gICAgICByZXNldFNvcnRTdGF0dXModGFibGVIZWFkZXJFbGVtZW50cyk7XG4gICAgICBsZXQgdHJIVE1MID0gJyc7XG4gICAgICBkYXRhLmZvckVhY2goKHZhbHVlKSA9PiB7XG4gICAgICAgIHRySFRNTCArPSAnPHRyPic7XG4gICAgICAgIHRySFRNTCArPSBidWlsZFRkRWxlbSgnbGFzdCcsIHZhbHVlLmxhc3QsIGZhbHNlKTtcbiAgICAgICAgdHJIVE1MICs9IGJ1aWxkVGRFbGVtKCdmaXJzdCcsIHZhbHVlLmZpcnN0LCBmYWxzZSk7XG4gICAgICAgIGlmKHZhbHVlLm0gPT09ICdOb25lJykge1xuICAgICAgICAgIHRySFRNTCArPSBidWlsZFRkRWxlbSgnbm9uZScsIHZhbHVlLm0sIGZhbHNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0ckhUTUwgKz0gYnVpbGRUZEVsZW0oJ20nLCB2YWx1ZS5tLCBmYWxzZSk7XG4gICAgICAgIH0gICAgICBcbiAgICAgICAgdHJIVE1MICs9IGJ1aWxkVGRFbGVtKHZhbHVlLnBldC50b0xvd2VyQ2FzZSgpLCB2YWx1ZS5wZXQsIHRydWUpO1xuICAgICAgICB0ckhUTUwgKz0gYnVpbGRUZEVsZW0oJ2JpcnRoZGF5JywgdmFsdWUuYmlydGhkYXksIGZhbHNlKTtcbiAgICAgICAgdHJIVE1MICs9IGJ1aWxkVGRFbGVtKCdjb2xvcicsIHZhbHVlLmNvbG9yLCBmYWxzZSk7XG4gICAgICAgIHRySFRNTCArPSAnPC90cj4nO1xuICAgICAgfSk7XG4gICAgICB0YWJsZUJvZHkuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCB0ckhUTUwpO1xuICAgICAgU29ydGFibGUuaW5pdCgpO1xuXG4gICAgICBjb25zdCByb3dzID0gdGFibGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0Ym9keVwiKVswXS5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRyXCIpLmxlbmd0aDtcbiAgICAgIHBlb3BsZUNvdW50LmlubmVySFRNTCA9IHJvd3M7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4geyBjb25zb2xlLmxvZyhlcnIpOyB9KTtcbiAgfSwgZmFsc2UpO1xufSkoKTsiXX0=
